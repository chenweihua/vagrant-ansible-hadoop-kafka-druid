# Druid Overlord Service

description "Druid Overlord"

#start on runlevel [2345]
#stop on starting rc RUNLEVEL=[016]

#respawn
#respawn limit 2 5

#umask 007

#kill timeout 300

#pre-start script
#    #Sanity checks
#    [ -r {{ druid_upstart_common_dir }}/common.runtime.properties ]
#    #[ -r {{ druid_conf_dir }}/overlord/runtime.properties ]
#end script

setuid druid
setgid druid

script
chdir {{druid_dir}}
{% if druid_storage_type is defined and druid_storage_type == "hdfs" and druid_storage_storageDirectory is defined and druid_storage_storageDirectory != "druid_storage_storageDirectory" %}
exec {{druid_upstart_java_exec}} {{ druid_upstart_overlord_jvm_properties }} -classpath {{ druid_upstart_common_dir }}:{{ druid_upstart_overlord_lib_classpath }}:{{ druid_hadoop_classpath }} io.druid.cli.Main server overlord
{% else %}
exec {{druid_upstart_java_exec}} {{ druid_upstart_overlord_jvm_properties }} -classpath {{ druid_upstart_common_dir }}:{{ druid_upstart_overlord_lib_classpath }} io.druid.cli.Main server overlord
{% endif %}
end script